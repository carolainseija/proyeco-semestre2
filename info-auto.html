<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Info auto</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-wEmeIV1mKuiNpC+IOBjI7aAzPcEZeedi5yW5f2yOq55WWLwNGmvvx4Um1vskeMj0" crossorigin="anonymous">
</head>

<body>
    <div class="container" style="max-width: none; min-height: 85vh; padding: 0px;">
        <nav class="navbar navbar-expand-sm" style="background-color: #d2d1d1; padding: 0 7%;">
            <div class="container-fluid">
                <a class="navbar-brand" href="/">
                    <img style="height: 80px; width: 200px;" src="/logo.png" />
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#opciones">
                    <img style="width: 25px; height: 25px;" src="/nav.png" />
                </button>
                <div class="collapse navbar-collapse justify-content-end" id="opciones"
                    style="background-color: #d2d1d1;">
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="nav-link text-dark" href="/">Inicio</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-dark" href="/sobre-nosotros">Sobre Nosotros</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link text-dark" href="/administrador">Administrador</a>
                        </li>
                    </ul>
                </div>
            </div>
        </nav>
        <div class="container">
            <div class="row mt-5">
                <div class="col-md-6" id="img-auto">

                </div>
                <div class="col-md-6">
                    <ul id="lista" class="list-group list-group-flush">
                    </ul>
                </div>
            </div>
            <div class="row mt-5">
                <div class="container my-5">
                    <div class="card shadow-sm" style="background-color: aliceblue;">
                        <div class="card-body">
                            <h5 class="card-title">Descripción:</h5>
                            <p class="card-text" id="text-descripción">
                            </p>
                            <div id="caracteristicas">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="container">
        <div class="modal fade" id="dialogo1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <!-- cabecera del diálogo -->
                    <div class="modal-header">
                        <h5 class="modal-title" id="exampleModalLabel">El auto ha quedado reservado.</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <!-- cuerpo del diálogo -->
                    <div class="modal-body">
                       <p>Recuerden que tienen 24 horas para concretar la venta. Proceder con la documentación y coordinación para la entrega.</p>
                    </div>
                    <!-- pie del diálogo -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="position-fixed" style="right: 1%; bottom: 5%;">
        <button style="background-color: transparent; border: none;" onclick="wpp()">
            <a id="wpp" target="_blank" class="whatsapp">
                <img style="width: 70px; height: 70px;" src="/whatsapp.png" alt="logo wpp" />
            </a>
        </button>
    </div>
    <div class="container mt-5">
        <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
            <p class="col-md-3 mb-0 text-body-secondary">© 2024 SSLC. Todos los derechos reservados.</p>

            <a href="/"
                class="col-md-4 d-flex align-items-center justify-content-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
                <img class="bi me-2" width="200" height="auto" src="/logo.png" alt="logo" />
            </a>

            <ul class="nav col-md-5 justify-content-end">
                <li class="nav-item nav-link px-2 text-body-secondary">Stella González</li>
                <li class="nav-item nav-link px-2 text-body-secondary">Sofia Moreira</li>
                <li class="nav-item nav-link px-2 text-body-secondary">Lucas Rodríguez</li>
                <li class="nav-item nav-link px-2 text-body-secondary">Carolain Seija</li>

                <li class="nav-item nav-link px-2 text-body-secondary">Carlos Romero</li>
                <li class="nav-item nav-link px-2 text-body-secondary">Gabriel Barboza</li>
            </ul>

        </footer>
    </div>
    <script>
     
      
        const id = window.location.pathname.split('/').pop();
        const url = `http://localhost:3000/autos/${id}`;


        async function Reservar(id) {

            const respuesta = await fetch(`http://localhost:3000/autos/reservar/${id}`, {
                method: 'PUT',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    dato: "reservado"
                })
            });
            obtenerAuto()
        }




        let info = ""
        async function obtenerAuto() {
            const res = await fetch(url);
            const auto = await res.json();
            info = `Estimado cliente, le enviamos la información: ${auto.marca}, ${auto.modelo}, año: ${auto.año}, precio: USD ${auto.precio}.`;

            let imgAuto = document.getElementById("img-auto"); //contenedor donde va el auto
            const rutaImagen = id > 6 ? `/autos` : `/auto${id}`;

            imgAuto.innerHTML = `
              <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                        <ol class="carousel-indicators">
                          <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                          <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
                          <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
                          <li data-target="#carouselExampleIndicators" data-slide-to="3"></li>
                        </ol>
                        <div class="carousel-inner">
                          <div class="carousel-item active">
                            <img class="d-block w-100"  src="${rutaImagen}/1.jpeg"" alt="imagen 1">
                          </div>
                          <div class="carousel-item">
                            <img class="d-block w-100" src="${rutaImagen}/2.jpeg" alt="imagen 2">
                          </div>
                          <div class="carousel-item">
                            <img class="d-block w-100"  src="${rutaImagen}/3.jpeg" alt="imagen 3">
                          </div>
                               <div class="carousel-item">
                            <img class="d-block w-100"   src="${rutaImagen}/4.jpeg"  alt="imagen 4">
                          </div>                          
                        </div>
                        <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                          <span class="sr-only">Previous</span>
                        </a>
                        <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                          <span class="carousel-control-next-icon" aria-hidden="true"></span>
                          <span class="sr-only">Next</span>
                        </a>
                      </div>
            `


            let textDescripción = document.getElementById("text-descripción")
            textDescripción.innerText = `${auto.descripción}`

            let lista = document.getElementById('lista');
            lista.innerHTML = '';
            // data-bs-toggle="modal" data-bs-target="#dialogo1" : ESTO ES LO QUE HACE QUE ABRA EL MODAL CON EL BOTON
            const elemento = `
                        <li style="list-style: none; margin-left: 10px;">
                            <h3>${auto.marca} ${auto.modelo}</h3>
                        </li>
                        <li style="list-style: none; margin-left: 10px;">
                            <h5>${auto.tipo}</h5>
                        </li>
                        <li class="list-group-item">Año: 2024</li>
                        <li class="list-group-item">${auto.kilometros}KM</li>
                        <li class="list-group-item">Puertas: ${auto.cantPuertas} </li>
                        <li class="list-group-item">Combustible: ${auto.combustible}</li>
                        <li class="list-group-item">Color: ${auto.color}</li>
                        <li class="list-group-item">Motor: ${auto.motor}</li>
                        <button type="button" style="width: 100%;" class="btn btn-secondary btn-lg btn-block">USD
                        ${auto.precio}
                        </button>
                        <div style="display: flex; justify-content: center; margin: 10px;">

                        <button data-bs-toggle="modal" data-bs-target="#dialogo1" onclick="Reservar(${auto.id})" style="width: 150px;" type="button" class="btn btn-dark rounded-5 text-light">RESERVAR</button>
                        </div>
                        
                        `

                ;

            let caracteristicas = document.getElementById('caracteristicas');
            auto.caracteristicas.forEach(caracteristica => {
                const elementoCaracteristicas = `
                    <button style="background-color: white; border-radius: 5px;border: 4px solid rgba(13, 110, 253, .25);" class="btn">${caracteristica}</button>
                    `
                caracteristicas.innerHTML += elementoCaracteristicas;
            });

            lista.innerHTML += elemento;
        }





        function wpp() {
            console.log("info", info)
            const numero = prompt("¿Cuál es tu número sin el cero?");
            // const info = "El valor del auto es 2000"
             const linkWpp = `https://wa.me/598${numero}?text=${info}`;
            // const linkWpp = `https://api.whatsapp.com/send/?phone=598${numero}&text=${encodeURIComponent("Te paso la info")}&type=phone_number&app_absent=0`;

             window.location.href = linkWpp;
        }

      
        obtenerAuto()


      
    </script>
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-p34f1UUtsS3wqzfto5wAAmdvj+osOnFyQFpp4Ua3gs/ZVWx6oOypYoCJhGGScy+8"
        crossorigin="anonymous"></script>

</body>

</html>